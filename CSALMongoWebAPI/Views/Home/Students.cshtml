@{
    ViewBag.Title = "Students";
}

<!-- MAIN CONTENT -->
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <table id="all-students" class="table table-striped apply-data-table">
                <caption>All Students</caption>
                <thead>
                    <tr>
                        <th>Subject (User) ID</th>
                        <th>Last Interaction</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div> <!-- /container -->

@section ScriptFinal {
<script>
    $(document).ready(function () {
        $('.apply-data-table').dataTable();

        CSALCommon.doServerGet("/api/students", "Getting Student Information", function (data) {
            var makeRow = function (student) {
                return [
                    student["UserID"],
                    CSALCommon.trimmedStr(student["LastTurnTime"])
                ];
            };

            var rows = [];
            $.each(data, function (index, element) {
                rows.push(makeRow(element));
            });

            CSALCommon.showRows("#all-students", rows);

            var tableRows = $("#all-students").find("tbody").children();
            $.each(tableRows, function (index, element) {
                var studentTd = $(element).find("td").first();
                var link = $("<a class='student-link'></a>").text(studentTd.text());
                studentTd.html("").append(link);
            });

            $(".student-link").click(function (evt) {
                evt.preventDefault();
                //TODO: actual drill-down functionality
                alert("TODO: jump/display to detail screen for " + $(this).text());
            });
        });
    });
</script>
}
